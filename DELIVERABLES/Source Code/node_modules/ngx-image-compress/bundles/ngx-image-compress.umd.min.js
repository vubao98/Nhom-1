!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-image-compress",["exports","@angular/core"],t):t(e["ngx-image-compress"]={},e.ng.core)}(this,function(e,t){"use strict";var p={Up:1,Down:3,Right:6,Left:8,UpMirrored:2,DownMirrored:4,LeftMirrored:5,RightMirrored:7,NotJpeg:-1,NotDefined:-2};p[p.Up]="Up",p[p.Down]="Down",p[p.Right]="Right",p[p.Left]="Left",p[p.UpMirrored]="UpMirrored",p[p.DownMirrored]="DownMirrored",p[p.LeftMirrored]="LeftMirrored",p[p.RightMirrored]="RightMirrored",p[p.NotJpeg]="NotJpeg",p[p.NotDefined]="NotDefined";var i=function(){function a(){}return a.getOrientation=function(e,u){var c=new FileReader;try{c.onload=function(e){var t=new DataView(c.result);if(65496!==t.getUint16(0,!1))return u(-2);for(var r=t.byteLength,n=2;n<r;){var i=t.getUint16(n,!1);if(n+=2,65505===i){if(1165519206!==t.getUint32(n+=2,!1))return u(-1);var o=18761===t.getUint16(n+=6,!1);n+=t.getUint32(n+4,o);var a=t.getUint16(n,o);n+=2;for(var d=0;d<a;d++)if(274===t.getUint16(n+12*d,o))return u(t.getUint16(n+12*d+8,o))}else{if(65280!=(65280&i))break;n+=t.getUint16(n,!1)}}return u(-1)},c.readAsArrayBuffer(e)}catch(t){return u(0)}},a.uploadFile=function(t){return new Promise(function(i,o){var e=t.createElement("input");t.setStyle(e,"display","none"),t.setProperty(e,"type","file"),t.listen(e,"click",function(e){e.target.value=null}),t.listen(e,"change",function(e){var t=e.target.files[0],r=new FileReader;r.onloadend=function(e){try{a.getOrientation(t,function(e){i({image:r.result,orientation:e})})}catch(e){o(e)}};try{r.readAsDataURL(t)}catch(n){console.warn("ngx-image-compress - probably no file have been selected: "+n),o("No file selected")}}),e.click()})},a.compress=function(s,f,g,l,h){return void 0===l&&(l=50),void 0===h&&(h=50),new Promise(function(u,e){h/=100,l/=100;var c=new Image;c.onload=function(){var e,t,r=g.createElement("canvas"),n=r.getContext("2d");if(e=c.naturalWidth,t=c.naturalHeight,f===p.Right||f===p.Left){var i=e;e=t,t=i}r.width=e*l,r.height=t*l;var o=Math.PI/180;f===p.Up?n.drawImage(c,0,0,r.width,r.height):f===p.Right?(n.save(),n.rotate(90*o),n.translate(0,-r.width),n.drawImage(c,0,0,r.height,r.width),n.restore()):f===p.Left?(n.save(),n.rotate(-90*o),n.translate(-r.width,0),n.drawImage(c,0,0,r.height,r.width),n.restore()):f===p.Down?(n.save(),n.rotate(180*o),n.translate(-r.width,-r.height),n.drawImage(c,0,0,r.width,r.height),n.restore()):(console.warn("ngx-image-compress - no orientation value found"),n.drawImage(c,0,0,r.width,r.height));var a=s.substr(5,s.split(";")[0].length-5),d=r.toDataURL(a,h);u(d)},c.src=s})},a.byteCount=function(e){return encodeURI(e).split(/%..|./).length-1},a}(),r=function(){function e(e){this.DOC_ORIENTATION=p,this.render=e.createRenderer(null,null)}return e.prototype.byteCount=function(e){return i.byteCount(e)},e.prototype.uploadFile=function(){return i.uploadFile(this.render)},e.prototype.compressFile=function(e,t,r,n){return void 0===r&&(r=50),void 0===n&&(n=50),i.compress(e,t,this.render,r,n)},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:t.RendererFactory2}]},e}();e.NgxImageCompressService=r,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-image-compress.umd.min.js.map